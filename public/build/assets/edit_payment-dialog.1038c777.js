import{d as we,a as s,o as xe,c as i,e as te,f as l,w as a,y as oe,s as t,j as Ce,k as Se,l as R,m as g,n as d,aI as ue,aD as m,t as V,E as p,q as y,a3 as b,z as U,i as k,p as O,B as ne,aJ as Ue,a9 as h,a1 as se,M as j,aF as Ie,aG as Pe,C as E,D as F,aA as de,U as De}from"./main.dc3150f2.js";import{_ as Ne}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang.d9594284.js";import{V as Ae}from"./VFileInput.a98189c2.js";const Re=I=>(Ie("data-v-ef49ce90"),I=I(),Pe(),I),Ee={key:2,class:"text-center"},Fe=Re(()=>j("h5",{class:"text-center text-blue"}," Proof of Payment ",-1)),Me={class:"float-right"},Be={class:"float-right"},qe=we({__name:"edit_payment-dialog",props:["row"],emits:["close","handledata"],setup(I,{emit:$}){const c=I,J=s(),P=s(!1),M=s(!1),B=s(!1),q=JSON.parse(localStorage.getItem("accessToken")||"{}"),D=s(),N=s(),A=s(),r=s(),re=s(),Q=s(),w=s(),_=s(null),L=s(null),C=s(!1),ie=()=>{C.value=!0},S=s(!1),me=()=>{S.value=!0},ce=()=>{if(_.value&&_.value.files&&_.value.files.length>0){const u=_.value.files[0],e=new FileReader;e.onload=n=>{n.target&&typeof n.target.result=="string"&&(L.value=n.target.result)},e.readAsDataURL(u)}},fe=()=>{P.value=!0},Z=()=>{P.value=!1},G=s(),f=s(),pe=s(),x=s(),v=s(),z=s(),ve=()=>{E.get(F.API_URL+"client/client/get-mode-of-payment",{params:{token:q}}).then(u=>{if(u.data.success&&u.data.mode){const e=u.data.mode.map(n=>({item:n.name,value:n.id}));G.value=e,de(()=>{if(r.value!==null){const n=r.value;_e(n)}})}})},_e=u=>{E.get(F.API_URL+"client/client/get-mode-of-payment/"+u,{params:{token:q}}).then(e=>{e.data.success&&(f.value=e.data.mode[0],f.value&&"qr_code_image"in f.value&&(pe.value="/storage/qr_code_image/"+f.value.qr_code_image))})},Y=s(),T=s(),ge=()=>{E.get(F.API_URL+"client/client/get-services",{params:{token:q}}).then(u=>{if(u.data.success&&u.data.services){const e=u.data.services.map(n=>({item:n.name,value:n.id}));Y.value=e,de(()=>{if(x.value!==null){const n=x.value;Ve(n)}})}})},Ve=u=>{E.get(F.API_URL+"client/client/get-services/"+u,{params:{token:q}}).then(e=>{e.data.success&&(T.value=e.data.services[0],T.value&&"price"in T.value&&(w.value=T.value.price))})},ye=()=>{ve(),ge()},be=()=>{var e;const u=new FormData;if(u.append("client_id",Q.value),u.append("serviceName",x.value),u.append("mode_of_payment_id",r.value),u.append("amount",w.value),v.value!=null&&u.append("account_sender",v.value),r.value===1&&(u.append("or_number",D.value),u.append("account_sender","")),r.value===2&&u.append("reference_number",N.value),u.append("date_of_payment",A.value),((e=_.value)==null?void 0:e.files)&&_.value.files.length>0){const n=_.value.files[0];u.append("proofofpayment",n)}E.post(F.API_URL+`client/client/edit-payment/${c.row.id}`,u,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{n.data.success&&($("close"),$("handledata",n.data))})},ke=()=>{var u;fe(),(u=J.value)==null||u.validate().then(({valid:e})=>{e?(be(),M.value=!0,Z()):(B.value=!0,Z())})},H=()=>{$("close")};return xe(()=>{var u,e,n,o,K,W,X,ee,le,ae;c.row!=null&&(Q.value=(u=c.row)==null?void 0:u.client_id,w.value=(e=c.row)==null?void 0:e.amount,D.value=(n=c.row)==null?void 0:n.or_number,N.value=(o=c.row)==null?void 0:o.reference_number,A.value=(K=c.row)==null?void 0:K.date_of_payment,r.value=(W=c.row)==null?void 0:W.modeofpayment.id,re.value=(X=c.row)==null?void 0:X.proof_of_payment,v.value=(ee=c.row)==null?void 0:ee.account,x.value=(le=c.row)==null?void 0:le.services.id,z.value="/storage/proofofpayment_image/"+((ae=c.row)==null?void 0:ae.proof_of_payment)),ye()}),(u,e)=>{const n=Ne;return i(),te("section",null,[l(n,{onClick:H}),l(O,{"max-height":"580px",class:"d-flex flex-column flex-grow-1 overflow-auto",title:"Edit Payment"},{default:a(()=>[l(oe),l(t(Ce),{ref_key:"refsubmit",ref:J,onSubmit:Se(ke,["prevent"])},{default:a(()=>[l(R,null,{default:a(()=>[l(g,null,{default:a(()=>[l(d,{class:"mb-2"},{default:a(()=>[l(ue,{modelValue:t(x),"onUpdate:modelValue":e[0]||(e[0]=o=>m(x)?x.value=o:null),rules:[t(V)],label:"Services",items:t(Y),"item-title":"item","item-value":"value"},null,8,["modelValue","rules","items"])]),_:1}),t(w)?(i(),p(d,{key:0,class:"mb-2"},{default:a(()=>[l(y,{modelValue:t(w),"onUpdate:modelValue":e[1]||(e[1]=o=>m(w)?w.value=o:null),readonly:"",label:"Amount"},null,8,["modelValue"])]),_:1})):b("",!0)]),_:1}),l(g,null,{default:a(()=>[l(d,null,{default:a(()=>[l(ue,{modelValue:t(r),"onUpdate:modelValue":e[2]||(e[2]=o=>m(r)?r.value=o:null),rules:[t(V)],label:"Mode Of Payment",items:t(G),"item-title":"item","item-value":"value"},null,8,["modelValue","rules","items"])]),_:1})]),_:1}),l(g,null,{default:a(()=>[t(r)==1?(i(),p(d,{key:0},{default:a(()=>[l(y,{modelValue:t(D),"onUpdate:modelValue":e[3]||(e[3]=o=>m(D)?D.value=o:null),rules:[t(V)],label:"O.R Number"},null,8,["modelValue","rules"])]),_:1})):b("",!0),t(r)==2?(i(),p(d,{key:1},{default:a(()=>[l(y,{modelValue:t(N),"onUpdate:modelValue":e[4]||(e[4]=o=>m(N)?N.value=o:null),rules:[t(V)],label:"Referece Number"},null,8,["modelValue","rules"])]),_:1})):b("",!0),t(r)>2&&t(f)?(i(),p(d,{key:2},{default:a(()=>[t(f).account?(i(),p(y,{key:0,modelValue:t(f).account,"onUpdate:modelValue":e[5]||(e[5]=o=>t(f).account=o),rules:[t(V)],readonly:"",label:"Account Number",class:"mb-2"},null,8,["modelValue","rules"])):b("",!0),t(f).account?(i(),p(y,{key:1,modelValue:t(v),"onUpdate:modelValue":e[6]||(e[6]=o=>m(v)?v.value=o:null),rules:[t(V)],type:"number",label:"Sender Account Number"},null,8,["modelValue","rules"])):(i(),te("h5",Ee,"No Account Number"))]),_:1})):b("",!0)]),_:1}),t(r)==2&&t(f)?(i(),p(g,{key:0},{default:a(()=>[l(d,null,{default:a(()=>[l(y,{modelValue:t(v),"onUpdate:modelValue":e[7]||(e[7]=o=>m(v)?v.value=o:null),rules:[t(V)],type:"number",label:"Sender Account Number"},null,8,["modelValue","rules"])]),_:1}),l(d,null,{default:a(()=>[l(y,{modelValue:t(f).account,"onUpdate:modelValue":e[8]||(e[8]=o=>t(f).account=o),readonly:"",label:"Receiver Account Number"},null,8,["modelValue"])]),_:1})]),_:1})):b("",!0),l(g,null,{default:a(()=>[l(d,{class:"mb-2"},{default:a(()=>[l(y,{modelValue:t(A),"onUpdate:modelValue":e[9]||(e[9]=o=>m(A)?A.value=o:null),type:"date",rules:[t(V)],label:"Date of Payment"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(g,null,{default:a(()=>[l(d,null,{default:a(()=>[Fe]),_:1})]),_:1}),l(g,null,{default:a(()=>[l(d,{class:"mb-2"},{default:a(()=>[l(Ae,{accept:".jpg,.jpeg,.png",ref_key:"fileInputImage",ref:_,chips:"",label:"Select File",onChange:ce,"prepend-icon":"tabler:photo-edit"},null,512)]),_:1})]),_:1}),l(g,{class:"text-center"},{default:a(()=>[t(L)?(i(),p(d,{key:0},{default:a(()=>[l(U,{color:"primary",variant:"tonal","prepend-icon":"material-symbols:photo-camera-back-outline-sharp",size:"small",onClick:ie},{default:a(()=>[k(" Click ME!")]),_:1})]),_:1})):(i(),p(d,{key:1},{default:a(()=>[l(U,{color:"blue",variant:"tonal",size:"small",onClick:me,"prepend-icon":"material-symbols:photo-camera-back-outline-sharp"},{default:a(()=>[k(" Click ME!")]),_:1})]),_:1}))]),_:1})]),_:1}),l(oe),l(d,{class:"mt-5 mb-2",style:{"text-align":"right"}},{default:a(()=>[l(U,{type:"submit","prepend-icon":"tabler-edit",class:"mr-2"},{default:a(()=>[k(" Update")]),_:1}),l(U,{color:"error",onClick:H,"prepend-icon":"material-symbols-light:tab-close-outline"},{default:a(()=>[k("Cancel")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),l(ne,{modelValue:t(M),"onUpdate:modelValue":e[10]||(e[10]=o=>m(M)?M.value=o:null),timeout:4e3,color:"success"},{default:a(()=>[k(" Success! Payment Data Edited. ")]),_:1},8,["modelValue"]),l(ne,{modelValue:t(B),"onUpdate:modelValue":e[11]||(e[11]=o=>m(B)?B.value=o:null),timeout:4e3,color:"error"},{default:a(()=>[k(" Erorr! Please Check Your Field. ")]),_:1},8,["modelValue"]),l(h,{modelValue:t(P),"onUpdate:modelValue":e[12]||(e[12]=o=>m(P)?P.value=o:null),"max-width":"300"},{default:a(()=>[l(Ue)]),_:1},8,["modelValue"]),l(h,{modelValue:t(C),"onUpdate:modelValue":e[15]||(e[15]=o=>m(C)?C.value=o:null),"max-width":"500"},{default:a(()=>[l(n,{onClick:e[13]||(e[13]=o=>C.value=!1)}),l(O,{title:"Preview",class:"d-flex flex-column flex-grow-1 overflow-auto"},{default:a(()=>[t(L)?(i(),p(R,{key:0},{default:a(()=>[l(se,{class:"circle-image",src:t(L),alt:"Zoomed Image"},null,8,["src"])]),_:1})):b("",!0),l(R,null,{default:a(()=>[l(d,null,{default:a(()=>[j("div",Me,[l(U,{onClick:e[14]||(e[14]=o=>C.value=!1),color:"error"},{default:a(()=>[k("Close")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(h,{modelValue:t(S),"onUpdate:modelValue":e[18]||(e[18]=o=>m(S)?S.value=o:null),"max-width":"500"},{default:a(()=>[l(n,{onClick:e[16]||(e[16]=o=>S.value=!1)}),l(O,{title:"Preview Uploaded",class:"d-flex flex-column flex-grow-1 overflow-auto"},{default:a(()=>[t(z)?(i(),p(R,{key:0},{default:a(()=>[l(se,{class:"circle-image",src:t(z),alt:"Zoomed Image"},null,8,["src"])]),_:1})):b("",!0),l(R,null,{default:a(()=>[l(d,null,{default:a(()=>[j("div",Be,[l(U,{onClick:e[17]||(e[17]=o=>S.value=!1),color:"error"},{default:a(()=>[k("Close")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});const ze=De(qe,[["__scopeId","data-v-ef49ce90"]]);export{ze as default};
