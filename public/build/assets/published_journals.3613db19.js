import{d as Ie,a as n,aO as Z,bM as we,Z as Ae,C as k,D as L,o as ke,c as u,e as x,f as t,w as l,l as Le,M as s,aZ as Q,aI as Te,S as K,z as T,k as M,s as c,bJ as ee,A as E,i as m,q as Me,bs as Ee,n as Oe,a1 as te,F as Ue,G as qe,W as i,E as O,a8 as U,a3 as P,bI as je,bH as ze,bt as Fe,p as Re,a9 as ae,bL as Ne,aF as Ye,aG as Be,U as $e}from"./main.dc3150f2.js";import{h as He}from"./moment.40bc58bf.js";import{e as Je}from"./excelPaidList.6a4350d3.js";import{E as We}from"./jspdf.plugin.autotable.5f00a359.js";import{_ as Ge}from"./publishedPrintDialog.vue_vue_type_style_index_0_lang.f9bd4c4d.js";import"./exceljs.min.6ef7067d.js";const V=v=>(Ye("data-v-ca5c4110"),v=v(),Be(),v),Xe={class:"me-3",style:{display:"flex",width:"10.5rem","align-items":"center"}},Ze=V(()=>s("strong",null,"Show",-1)),Qe=V(()=>s("strong",null,"entries",-1)),Ke={class:"app-user-search-filter d-flex align-center flex-wrap gap-4 justify-end"},et={style:{display:"flex",width:"17rem","align-items":"center"}},tt=V(()=>s("thead",null,[s("tr",null,[s("th",{class:"text-center"},"No."),s("th",{class:"text-center"},"Client Fullname"),s("th",{class:"text-center"},"Published File"),s("th",{class:"text-center"},"Date of Published"),s("th",{class:"text-center"},"Status")])],-1)),at={class:"text-center"},st={class:"text-center"},lt={class:"text-center"},ot={class:"text-center"},nt=V(()=>s("br",null,null,-1)),rt={class:"text-center"},it={key:0},dt={colspan:"8"},ct={style:{"text-align":"center"},class:"mb-5 mt-5"},ut=Ie({__name:"published_journals",setup(v){const S=JSON.parse(localStorage.getItem("editorData")||"null"),f=n([]),C=n(),p=n(),q=n(1),j=[5,20,50,100,500],g=n(j[0]);n(g.value);const D=n(q),h=n(),z=n(g);n(null),n(),n();const F=Z(()=>{const o=(q.value-1)*g.value,a=o+g.value;return f.value.slice(o,a)});let se=Z(()=>f.value.length>0?Math.ceil(f.value.length/g.value):0);function le(){D.value=1}const oe=()=>{k.get(L.API_URL+"editor/editor/search-published-journal/"+S[0].id,{params:{query:p.value,token:R}}).then(o=>{o.data.success&&(f.value=o.data.searchPublished)}).catch(o=>{console.log("Error")})},ne=we.exports.debounce(()=>{p.value===""?N():oe()});Ae([p],ne);const R=JSON.parse(localStorage.getItem("accessToken")||"{}"),N=()=>{k.get(L.API_URL+"editor/editor/get-published-journal/"+S[0].id,{params:{token:R}}).then(o=>{o.data.success&&(f.value=o.data.publisheddata)})},re=()=>{N()},y=n(!1),ie=()=>{y.value=!0},Y=n(),de=async()=>{var o;await k.get(L.API_URL+"editor/editor/get-reset-pass-editor/"+((o=S[0])==null?void 0:o.id)).then(a=>{var e;a.data.success&&(Y.value=(e=a.data.editor[0])==null?void 0:e.reset_password_status,Y.value===1&&ie())})};ke(async()=>{await de(),re()});const ce=()=>{h.value=!0,h.value==!0&&setTimeout(()=>{window.print()},1e3),window.addEventListener("beforeprint",()=>{}),window.addEventListener("afterprint",()=>{h.value=!1})};async function ue(o,a){try{const e=new We({orientation:"landscape",unit:"mm",format:"legal"}),b=[o][0].$el.querySelector("table"),me=b.querySelector("thead"),I=50,fe=10,w=5,pe=0,ge=3,he=I,_e=w,ve=40,B=40,ye="DIT.ADS- Published Journal List Management Report",be=e.internal.pageSize.getWidth()/2;e.setFont("Georgia","bold"),e.text(ye,be,30,{align:"center"}),e.addImage(a,he,_e,ve,B);const mt=e.internal.pageSize.getWidth()-I-fe,ft=e.internal.pageSize.getHeight()-w-pe,$=[],xe=[],H=b.querySelectorAll("tbody tr"),Pe=3;let Ve=0;H.forEach(d=>{const _=d.querySelectorAll("td")[Pe].querySelector("img");if(_){const A=_.getAttribute("src");$.push(new Promise(De=>{const X=new Image;X.onload=function(){const gt=I;Ve=d.offsetTop+w,xe.push(this.src),De()},X.src=A}))}}),await Promise.all($);const Se=me.querySelectorAll("th"),J=Array.from(Se).map(d=>d.innerText.trim()).filter(d=>d!=="Action"),W=[];H.forEach(d=>{const G=d.querySelectorAll("td"),_=Array.from(G).map(A=>A.innerText.trim());_.splice(ge,0),W.push(_)});const Ce=J.length+1;e.autoTable({head:[J],body:W,startY:B+10,margin:{top:5,right:10,bottom:5,left:10},styles:{cellPadding:2,fontSize:12},headStyles:{fillColor:"#00A36C",textColor:"#ffffff"},columnStyles:{[Ce-1]:{align:"center"}}}),e.save("Dit.Ads.pdf")}catch(e){console.error("Error generating PDF:",e)}}return n(null),(o,a)=>(u(),x("section",null,[t(Re,{title:"Published Journal List"},{default:l(()=>[t(Le,{class:"d-flex flex-wrap py-4 px-4 gap-2"},{default:l(()=>[s("div",Xe,[t(Q,{style:{"font-size":"small"},class:"mr-1"},{default:l(()=>[Ze]),_:1}),t(Te,{modelValue:z.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>z.value=e),le],items:j},null,8,["modelValue"]),t(Q,{style:{"font-size":"small"},class:"ml-1"},{default:l(()=>[Qe]),_:1})]),t(K),t(T,{color:"error",onClick:a[1]||(a[1]=M(e=>ue(C.value,c(ee)),["prevent"]))},{default:l(()=>[t(E,null,{default:l(()=>[m("tabler:file-type-pdf")]),_:1})]),_:1}),t(T,{onClick:a[2]||(a[2]=M(e=>c(Je)(C.value),["prevent"]))},{default:l(()=>[t(E,null,{default:l(()=>[m("tabler:file-spreadsheet")]),_:1})]),_:1}),t(T,{onClick:M(ce,["prevent"]),color:"warning"},{default:l(()=>[t(E,null,{default:l(()=>[m("tabler:printer")]),_:1})]),_:1},8,["onClick"]),t(K),s("div",Ke,[s("div",et,[t(Me,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),label:"Search",class:"search-field",solo:"","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])])])]),_:1}),t(Ee,{ref_key:"tableRef",ref:C},{default:l(()=>{var e;return[t(Oe,{hidden:"",class:"mb-5"},{default:l(()=>[t(te,{src:c(ee),alt:"Dit.Ads Logo",class:"logo"},null,8,["src"])]),_:1}),tt,s("tbody",null,[(u(!0),x(Ue,null,qe(c(F),(r,b)=>(u(),x("tr",{key:r.id},[s("td",at,i(b+1),1),s("td",st,i(r.client.firstname)+" "+i(r.client.middlename)+" "+i(r.client.lastname),1),s("td",lt,i(r.editor_uploaded_file),1),s("td",ot,[m(i(c(He)(r.updated_at).format("MMMM DD, YYYY"))+" ",1),nt]),s("td",rt,[r.editor_status=="Approved"?(u(),O(U,{key:0,color:"success",variant:"outlined"},{default:l(()=>[m(i(r.editor_status),1)]),_:2},1024)):P("",!0),r.editor_status=="Pending"?(u(),O(U,{key:1,color:"warning",variant:"outlined"},{default:l(()=>[m(i(r.editor_status),1)]),_:2},1024)):P("",!0),r.editor_status=="Rejected"?(u(),O(U,{key:2,color:"error",variant:"outlined"},{default:l(()=>[m(i(r.editor_status),1)]),_:2},1024)):P("",!0)])]))),128))]),((e=f.value)==null?void 0:e.length)==0?(u(),x("tfoot",it,[s("tr",null,[s("td",dt,[s("div",ct,[t(te,{src:c(je),style:{display:"inline-block","max-width":"100%",width:"35%",height:"55%","object-fit":"cover"}},null,8,["src"]),t(ze,{color:"primary",indeterminate:"",reverse:""})])])])])):P("",!0)]}),_:1},512),t(Fe,{length:c(se),modelValue:D.value,"onUpdate:modelValue":a[4]||(a[4]=e=>D.value=e)},null,8,["length","modelValue"])]),_:1}),t(ae,{fullscreen:"",modelValue:h.value,"onUpdate:modelValue":a[5]||(a[5]=e=>h.value=e),transition:"dialog-bottom-transition"},{default:l(()=>[t(Ge,{Data:c(F)},null,8,["Data"])]),_:1},8,["modelValue"]),t(ae,{modelValue:y.value,"onUpdate:modelValue":a[7]||(a[7]=e=>y.value=e),scrollable:"","max-width":"400",persistent:""},{default:l(()=>[t(Ne,{onClose:a[6]||(a[6]=e=>y.value=!1)})]),_:1},8,["modelValue"])]))}});const Pt=$e(ut,[["__scopeId","data-v-ca5c4110"]]);export{Pt as default};
