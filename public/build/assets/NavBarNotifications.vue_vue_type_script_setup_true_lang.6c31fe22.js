import{d as _e,b as he,a as A,c as o,e as b,s as m,E as _,w as l,f as a,z as N,A as I,a4 as Y,a5 as W,a6 as P,a8 as H,i as C,W as p,a3 as q,y as D,F as w,G as K,ab as fe,a0 as Q,M as h,O as M,m as X,n as Z,k as F,ac as ee,C as g,D as v,o as be}from"./main.dc3150f2.js";import{a as te}from"./formatters.6aea8434.js";import{a as $,V as le}from"./VBadge.2d4e0ef5.js";const ge={class:"text-success"},ve=h("br",null,null,-1),ye={key:0},ke={class:"whitespace-no-wrap text-medium-emphasis"},xe={class:"text-success"},qe=h("br",null,null,-1),Ae={key:0},Re={class:"whitespace-no-wrap text-medium-emphasis"},we={key:0},Ne={class:"whitespace-no-wrap text-medium-emphasis"},Ie=_e({__name:"Notifications",props:{notifications:null,data:null,item:null,badgeProps:{default:void 0},location:{default:"bottom end"},row:null,number:null,seq:null},emits:["data","dataAdmin","dataEditor"],setup(ae,{emit:f}){const i=ae,n=he();function L(r){const u=new Date,e=new Date(r),c=u-e,y=Math.floor(c/1e3),d=Math.floor(y/60),t=Math.floor(d/60),s=Math.floor(t/24);return s>1?`${s} d ago`:s===1?"Yesterday":t>0?`${t} h ago`:d>0?`${d} m ago`:y>0?`${y} s ago`:"Just now"}const E=JSON.parse(localStorage.getItem("clientData")||"{}"),J=()=>{var r;g.put(v.API_URL+"client/client/mark-as-read-all/"+((r=E[0])==null?void 0:r.id)).then(u=>{u.data.success&&f("data",u.data)})},O=()=>{g.put(v.API_URL+"auth/mark-as-read-all").then(r=>{r.data.success&&f("dataAdmin",r.data)})},T=(r,u,e,c,y,d,t)=>{u!=0?g.put(v.API_URL+"client/client/mark-as-read/"+r).then(s=>{f("data",s.data),e!==null&&c==null&&t==1?n.push("/client/transaction/payment"):e!==null&&c!==null&&t==1?d=="Approved"?n.push("/client/my-request/approved"):n.push("/client/my-request/rejected"):e!==null&&c!==null&&y==0&&t==0&&n.push("/client/publish_journal/download_docs")}):e!==null&&c==null&&t==1?n.push("/client/transaction/payment"):e!==null&&c!==null&&t==1?d=="Approved"?n.push("/client/my-request/approved"):n.push("/client/my-request/rejected"):e!==null&&c!==null&&y==0&&t==0&&n.push("/client/publish_journal/download_docs")};A(!1);const S=(r,u,e)=>{u!=0?g.put(v.API_URL+"auth/admin/mark-as-read/"+r).then(c=>{f("dataAdmin",c.data),e=="Payment Request"?n.push("/admin/request/paid_accounts"):e=="Journal Request"?n.push("/admin/request/uploaded_journal"):e=="Approved By Editor"?n.push("/admin/approved_editor/approved_for_editing"):e=="Editor Published a Journal"&&n.push("/admin/published/publishedjournal")}):e=="Payment Request"?n.push("/admin/request/paid_accounts"):e=="Journal Request"?n.push("/admin/request/uploaded_journal"):e=="Approved By Editor"?n.push("/admin/approved_editor/approved_for_editing"):e=="Editor Published a Journal"&&n.push("/admin/published/publishedjournal")},R=JSON.parse(localStorage.getItem("userRole")||"{}"),j=JSON.parse(localStorage.getItem("editorData")||"{}"),B=()=>{var r;g.put(v.API_URL+"editor/editor/mark-as-read-all/"+((r=j[0])==null?void 0:r.id)).then(u=>{u.data.success&&f("dataEditor",u.data)})},G=r=>{g.put(v.API_URL+"editor/editor/mark-as-read/"+r).then(u=>{u.data.success&&(f("dataEditor",u.data),n.push("/editor/approved_documents"))})};return(r,u)=>(o(),b(w,null,[m(R)=="Client"?(o(),_($,ee({key:0,"model-value":!!i.badgeProps},i.badgeProps),{default:l(()=>[a(N,{icon:"",variant:"text",color:"default",size:"small"},{default:l(()=>[r.$props.row>0?(o(),_($,{key:0,color:"error",content:r.$props.row},{default:l(()=>[a(I,{icon:"tabler-bell",size:"24"})]),_:1},8,["content"])):(o(),_(I,{key:1,icon:"tabler-bell",size:"24"})),a(Y,{activator:"parent",width:"380px",location:i.location,offset:"14px"},{default:l(()=>[a(W,{class:"py-0 d-flex flex-column flex-grow-1 overflow-auto","max-height":"400"},{default:l(()=>[a(P,{title:"Notifications",class:"notification-section",height:"48px"},{append:l(()=>[i.row?(o(),_(H,{key:0,color:"error",size:"small"},{default:l(()=>[C(p(i.row)+" Unread ",1)]),_:1})):q("",!0)]),_:1}),a(D),(o(!0),b(w,null,K(i.notifications,e=>(o(),b(w,{key:e.title},[a(P,{title:e.title,onClick:c=>T(e.id,e.subtitle,e.payment_id,e.request_id,e.publish,e.req_status,e.done),link:"",lines:"three","min-height":"66px"},fe({prepend:l(()=>[a(le,{start:""},{default:l(()=>[a(Q,{color:e.color||"primary",image:e.img||void 0,icon:e.icon||void 0,size:"40",variant:"tonal"},{default:l(()=>[e.text?(o(),b("span",ye,p(m(te)(e.text)),1)):q("",!0)]),_:2},1032,["color","image","icon"])]),_:2},1024)]),append:l(()=>[h("small",ke,p(L(e.time)),1)]),_:2},[e.done=="0"?{name:"subtitle",fn:l(()=>[h("small",ge,p(e.text),1),ve,h("span",{class:M({"unread-subtitle":e.subtitle=="1","read-subtitle":e.subtitle=="0"})},p(e.subtitle=="0"?"Read":"Unread"),3)]),key:"0"}:{name:"subtitle",fn:l(()=>[h("span",{class:M({"unread-subtitle":e.subtitle=="1","read-subtitle":e.subtitle=="0"})},p(e.subtitle=="0"?"Read":"Unread"),3)]),key:"1"}]),1032,["title","onClick"]),a(D)],64))),128))]),_:1}),a(X,null,{default:l(()=>[a(Z,null,{default:l(()=>[a(N,{block:"",onClick:F(J,["prevent"]),style:{width:"20px"}},{default:l(()=>[C(" READ ALL NOTIFICATIONS ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["location"])]),_:1})]),_:1},16,["model-value"])):q("",!0),m(R)=="Admin"||m(R)=="God Mode"?(o(),_($,ee({key:1,"model-value":!!i.badgeProps},i.badgeProps),{default:l(()=>[a(N,{icon:"",variant:"text",color:"default",size:"small"},{default:l(()=>[r.$props.number>0?(o(),_($,{key:0,color:"error",content:r.$props.number},{default:l(()=>[a(I,{icon:"tabler-bell",size:"24"})]),_:1},8,["content"])):(o(),_(I,{key:1,icon:"tabler-bell",size:"24"})),a(Y,{activator:"parent",width:"380px",location:i.location,offset:"14px"},{default:l(()=>[a(W,{class:"py-0 d-flex flex-column flex-grow-1 overflow-auto","max-height":"400"},{default:l(()=>[a(P,{title:"Notifications",class:"notification-section",height:"48px"},{append:l(()=>[a(H,{color:"error",size:"small"},{default:l(()=>[C(p(i.number)+" Unread ",1)]),_:1})]),_:1}),a(D),(o(!0),b(w,null,K(i.data,e=>(o(),b(w,{key:e.title},[a(P,{onClick:c=>S(e.id,e.subtitle,e.title),title:e.title,link:"",lines:"two","min-height":"66px"},{subtitle:l(()=>[h("small",xe,p(e.text),1),qe,h("span",{class:M({"unread-subtitle":e.subtitle=="1","read-subtitle":e.subtitle=="0"})},p(e.subtitle=="0"?"Read":"Unread"),3)]),prepend:l(()=>[a(le,{start:""},{default:l(()=>[a(Q,{color:e.color||"primary",image:"/storage/profile_image/"+e.img||void 0,icon:e.icon||void 0,size:"40",variant:"tonal"},{default:l(()=>[e.text?(o(),b("span",Ae,p(m(te)("hello")),1)):q("",!0)]),_:2},1032,["color","image","icon"])]),_:2},1024)]),append:l(()=>[h("small",Re,p(L(e.time)),1)]),_:2},1032,["onClick","title"]),a(D)],64))),128))]),_:1}),a(X,null,{default:l(()=>[a(Z,null,{default:l(()=>[a(N,{block:"",onClick:F(O,["prevent"]),style:{width:"20px"}},{default:l(()=>[C(" READ ALL NOTIFICATIONS ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["location"])]),_:1})]),_:1},16,["model-value"])):q("",!0),m(R)=="Editor"?(o(),_($,ee({key:2,"model-value":!!i.badgeProps},i.badgeProps),{default:l(()=>[a(N,{icon:"",variant:"text",color:"default",size:"small"},{default:l(()=>[r.$props.seq>0?(o(),_($,{key:0,color:"error",content:r.$props.seq},{default:l(()=>[a(I,{icon:"tabler-bell",size:"24"})]),_:1},8,["content"])):(o(),_(I,{key:1,icon:"tabler-bell",size:"24"})),a(Y,{activator:"parent",width:"380px",location:i.location,offset:"14px"},{default:l(()=>[a(W,{class:"py-0 d-flex flex-column flex-grow-1 overflow-auto","max-height":"400"},{default:l(()=>[a(P,{title:"Notifications",class:"notification-section",height:"48px"},{append:l(()=>[i.row?(o(),_(H,{key:0,color:"error",size:"small"},{default:l(()=>[C(p(i.seq)+" Unread ",1)]),_:1})):q("",!0)]),_:1}),a(D),(o(!0),b(w,null,K(i.item,e=>(o(),b(w,{key:e.title},[a(P,{title:e.title,link:"",lines:"two","min-height":"66px",onClick:F(c=>G(e.id),["prevent"])},{subtitle:l(()=>[h("span",{class:M({"unread-subtitle":e.subtitle=="1","read-subtitle":e.subtitle=="0"})},p(e.subtitle=="0"?"Read":"Unread"),3)]),prepend:l(()=>[a(le,{start:""},{default:l(()=>[a(Q,{color:e.color||"primary",image:e.img||void 0,icon:e.icon||void 0,size:"40",variant:"tonal"},{default:l(()=>[e.text?(o(),b("span",we,p(m(te)(e.text)),1)):q("",!0)]),_:2},1032,["color","image","icon"])]),_:2},1024)]),append:l(()=>[h("small",Ne,p(L(e.time)),1)]),_:2},1032,["title","onClick"]),a(D)],64))),128))]),_:1}),a(X,null,{default:l(()=>[a(Z,null,{default:l(()=>[a(N,{block:"",style:{width:"20px"},onClick:F(B,["prevent"])},{default:l(()=>[C(" READ ALL NOTIFICATIONS ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["location"])]),_:1})]),_:1},16,["model-value"])):q("",!0)],64))}});const me="/build/assets/DITADS Logo_PNG.6072795d.png",$e=_e({__name:"NavBarNotifications",setup(ae){const f=JSON.parse(localStorage.getItem("accessToken")||"{}"),i=A(),n=A(),L=JSON.parse(localStorage.getItem("clientData")||"{}"),E=()=>{var d;g.get(v.API_URL+`client/client/notification/${(d=L[0])==null?void 0:d.id}`,{params:{token:f}}).then(t=>{t.data.success&&(i.value=t.data.clientNotif,n.value=t.data.count,J=i.value.map(s=>{var k,x,z,V,U;return{id:s.id,time:s.time,img:me,payment_id:s.payment_id,request_id:s.request_id,req_status:(k=s.request)==null?void 0:k.request_status,publish:(x=s.request)==null?void 0:x.release_status,done:s.published,text:(z=s.request)==null?void 0:z.editor_uploaded_file,title:s.request?s.published=="1"?`Your Request is ${(V=s.request)==null?void 0:V.request_status}`:"The Journal is Published":`Your Payment is ${(U=s.payment)==null?void 0:U.payment_status}`,subtitle:s.is_read}}))})};let J=[];const O=A(),T=A();A(!1);const S=()=>{g.get(v.API_URL+"auth/notification",{params:{token:f}}).then(d=>{d.data.success&&(T.value=d.data.adminNotif,O.value=d.data.count,R=T.value.map(t=>{var s,k,x,z,V,U,se,re,oe,ie,ne,ue,de,ce,pe;return{id:t.id,time:t.time,img:t.editor_id!==null?(s=t.editor)==null?void 0:s.image:(k=t.payment)==null?void 0:k.client.image,payment_id:t.payment_id,request_id:t.request_id,req_status:(x=t.request)==null?void 0:x.editor_status,publish:(z=t.request)==null?void 0:z.release_status,done:t.published,journal:(V=t.request)==null?void 0:V.editor_uploaded_file,text:t.editor_id!==null?`${(U=t.editor)==null?void 0:U.lastname} ${(se=t.editor)==null?void 0:se.firstname} ${((re=t.editor)==null?void 0:re.middlename)||""}`:`${(oe=t.payment)==null?void 0:oe.client.firstname} ${(ie=t.payment)!=null&&ie.client.middlename?((ne=t.payment)==null?void 0:ne.client.middlename)+" ":""}${(ue=t.payment)==null?void 0:ue.client.lastname}`,title:t.request?t.editor_id!==null&&((de=t.request)==null?void 0:de.editor_status)==="Approved"&&t.published==1?"Approved By Editor":t.editor_id!==null&&((ce=t.request)==null?void 0:ce.editor_status)==="Approved"&&t.published==0?"Editor Published a Journal":t.editor_id!==null&&((pe=t.request)==null?void 0:pe.editor_status)==="Rejected"&&t.published==1?"Rejected by Editor":"Journal Request":"Payment Request",subtitle:t.is_read}}))})};let R=[];const j=A(),B=A(),G=JSON.parse(localStorage.getItem("editorData")||"{}"),r=()=>{var d;g.get(v.API_URL+"editor/editor/notification/"+((d=G[0])==null?void 0:d.id),{params:{token:f}}).then(t=>{t.data.success&&(B.value=t.data.editor,j.value=t.data.count,u=B.value.map(s=>{var k,x;return{id:s.id,time:s.time,img:me,payment_id:s.payment_id,request_id:s.request_id,req_status:(k=s.request)==null?void 0:k.request_status,subtitle:s.is_read,title:(x=s.request)==null?void 0:x.uploaded_file}}))})};let u=[];be(()=>{E(),S(),r(),setInterval(()=>{E(),S(),r()},6e4)});const e=()=>{E()},c=()=>{S()},y=()=>{r()};return setTimeout(()=>{r()}),(d,t)=>(o(),_(Ie,{onDataAdmin:c,notifications:m(J),data:m(R),item:m(u),number:m(O),row:m(n),seq:m(j),onData:e,onDataEditor:y},null,8,["notifications","data","item","number","row","seq"]))}});export{$e as _};
