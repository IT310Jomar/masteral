import{d as _e,aq as Ee,aO as z,cc as Fe,a as o,o as he,c as i,e as _,f as e,w as a,n as B,q as ge,s as m,aD as ie,aI as K,m as ve,cb as ze,C as Y,D as q,bM as Be,Z as He,l as de,z as E,k as F,i as p,M as t,aZ as ue,S as me,bJ as fe,A as Q,bs as Je,a1 as pe,F as $e,G as We,W as d,E as k,a8 as S,a3 as w,bI as je,bH as Ge,bt as Xe,p as ye,a9 as Ze,aF as Qe,aG as Ke,U as et}from"./main.dc3150f2.js";import{_ as tt}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang.96f694d0.js";import{h as at}from"./moment.40bc58bf.js";import{e as lt}from"./excelPaidList.6a4350d3.js";import{E as nt}from"./jspdf.plugin.autotable.5f00a359.js";import{_ as st}from"./paidPrintDialog.vue_vue_type_style_index_0_lang.1ca871c0.js";import"./exceljs.min.6ef7067d.js";const ot=_e({__name:"ApexChartBalance",setup(D){const g=JSON.parse(localStorage.getItem("accessToken")||"{}"),I=Ee(),h=z(()=>Fe(I.current.value)),R=o([]),b=o(null),P=o(),T=()=>{const f=new Date().getFullYear();for(let u=f;u>=f-10;u--)R.value.push(u)},v=o(),O=()=>{Y.get(q.API_URL+"auth/get-sales-request-data",{params:{year:b.value||(b.value=new Date().getFullYear()),token:g}}).then(f=>{v.value=f.data.sales,P.value=v.value.Total,H()})},x=o([{data:[]}]),H=()=>{const f=["January","February","March","April","May","June","July","August","September","October","November","December"];x.value[0].data=f.map(u=>v.value[u])};he(()=>{O(),T()});const M=z(()=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(P.value));return(f,u)=>(i(),_("section",null,[e(ve,{class:"mt-4"},{default:a(()=>[e(B,{class:"text-right ml-4"},{default:a(()=>[e(ge,{modelValue:m(M),"onUpdate:modelValue":u[0]||(u[0]=A=>ie(M)?M.value=A:null),readonly:"",label:"Total Sales",style:{"max-width":"250px"}},null,8,["modelValue"])]),_:1}),e(B,{class:"text-left mr-6"},{default:a(()=>[e(K,{modelValue:m(b),"onUpdate:modelValue":[u[1]||(u[1]=A=>ie(b)?b.value=A:null),O],items:m(R),label:"Select Year",solo:"",class:"ml-auto",style:{"max-width":"250px"},chips:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(m(ze),{type:"line",height:"400",options:m(h),series:m(x)},null,8,["options","series"])]))}}),V=D=>(Qe("data-v-652b41c0"),D=D(),Ke(),D),rt=V(()=>t("hr",{class:"mt-5"},null,-1)),ct={class:"me-3",style:{display:"flex",width:"10.5rem","align-items":"center"}},it=V(()=>t("strong",null,"Show",-1)),dt=V(()=>t("strong",null,"entries",-1)),ut={class:"app-user-search-filter d-flex align-center flex-wrap gap-4 justify-end"},mt={style:{display:"flex",width:"17rem","align-items":"center"}},ft={class:"app-user-search-filter d-flex align-center flex-wrap gap-4 justify-end"},pt={style:{width:"17rem",display:"flex","align-items":"center"}},yt=V(()=>t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"No."),t("th",{class:"text-center"},"Client Fullname"),t("th",{class:"text-center"},"Mode of Payment"),t("th",{class:"text-center"},"Sender Account Number"),t("th",{class:"text-center"},"Reference/O.R Number"),t("th",{class:"text-center"},"Date of Payment"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Amount")])],-1)),_t={class:"text-center"},ht={class:"text-center"},gt={class:"text-center"},vt={key:0,class:"text-center"},xt={key:1,class:"text-center"},bt=V(()=>t("h5",null,"No Sender Account Number",-1)),Pt=[bt],St={key:2,class:"text-center"},Vt={key:3,class:"text-center"},Ct={key:4,class:"text-center"},At=V(()=>t("h5",null,"No Reference/O.R Number",-1)),kt=[At],Dt={class:"text-center"},It={class:"text-center"},Rt={class:"text-center text-success"},Tt={key:0},Ot=V(()=>t("td",{colspan:"7",class:"text-right font-weight-bold"}," Total Amount: ",-1)),Mt={class:"text-center font-weight-bold"},Lt=V(()=>t("td",{colspan:"6"},null,-1)),Nt={key:0},Ut={colspan:"8"},wt={style:{"text-align":"center"},class:"mb-5 mt-5"},Yt=_e({__name:"salesReport",setup(D){const g=o([]),I=o(),h=o(),R=o(1),b=[5,20,50,100,500],P=o(b[0]);o(P.value);const T=o(R),v=o(),O=o(P),x=o(null),H=o(),M=o(),f=JSON.parse(localStorage.getItem("accessToken")||"{}"),u=o(),A=z(()=>{const s=(R.value-1)*P.value,l=s+P.value;return g.value.slice(s,l)});let xe=z(()=>g.value.length>0?Math.ceil(g.value.length/P.value):0);function be(){T.value=1}const ee=()=>{if(x.value!=null){const s=[];s.push(x.value);const l=s[0].split(" to ");Y.get(q.API_URL+"auth/admin/sales-list/range",{params:{startDate:H.value=l[0],endDate:M.value=l[1],paymentmode:C.value,token:f}}).then(r=>{C.value=[],r.data.success&&(x.value=null,g.value=r.data.salesData,u.value=r.data.totalAmount)})}},L=()=>{Y.get(q.API_URL+"auth/admin/search-sales-data",{params:{query:h.value,paymentmode:C.value,token:f}}).then(s=>{s.data.success&&(g.value=s.data.searchSales,u.value=s.data.totalAmount)}).catch(s=>{console.log("Error")})},Pe=Be.exports.debounce(()=>{h.value===""?J():h.value&&x.value?ee():h.value?(C.value=[],L()):C.value!==""?L():J()});He([h],Pe);const J=()=>{Y.get(q.API_URL+"auth/admin/get-sales-data-lists",{params:{token:f}}).then(s=>{s.data.success&&(g.value=s.data.salesdata)})},C=o(),te=o(),Se=()=>{Y.get(q.API_URL+"client/client/get-mode-of-payment",{params:{token:f}}).then(s=>{if(s.data.success&&s.data.mode){const r=[];for(var l=0;l<s.data.mode.length;l++){const c={item:s.data.mode[l].name,value:s.data.mode[l].id};r.push(c)}te.value=r}})};function Ve(){h.value="",L(),L()}const Ce=()=>{J(),Se()};he(()=>{Ce()});const Ae=()=>{v.value=!0,v.value==!0&&setTimeout(()=>{window.print()},1e3),window.addEventListener("beforeprint",()=>{}),window.addEventListener("afterprint",()=>{v.value=!1})};async function ke(s,l){try{const r=new nt({orientation:"landscape",unit:"mm",format:"legal"}),n=[s][0].$el.querySelector("table"),$=n.querySelector("thead"),W=50,De=10,j=5,Ie=0,qt=3,Re=W,Te=j,Oe=40,ae=40,Me="DIT.ADS- Sales List Management Report",Le=r.internal.pageSize.getWidth()/2;r.setFont("Arial","bold"),r.text(Me,Le,30,{align:"center"}),r.addImage(l,Re,Te,Oe,ae);const Et=r.internal.pageSize.getWidth()-W-De,Ft=r.internal.pageSize.getHeight()-j-Ie,le=[],Ne=[],ne=n.querySelectorAll("tbody tr"),Ue=3;let we=0;ne.forEach(y=>{const U=y.querySelectorAll("td")[Ue].querySelector("img");if(U){const re=U.getAttribute("src");le.push(new Promise(Z=>{const ce=new Image;ce.onload=function(){const zt=W;we=y.offsetTop+j,Ne.push(this.src),Z()},ce.src=re}))}}),await Promise.all(le);const Ye=$.querySelectorAll("th"),G=Array.from(Ye).map(y=>y.innerText.trim()),se=G.filter(y=>y!=="Action"&&y!=="Proof of Payment"),N=G.indexOf("Proof of Payment");N!==-1&&G.splice(N,1);const X=[];ne.forEach(y=>{const oe=y.querySelectorAll("td"),U=Array.from(oe).map(Z=>Z.innerText.trim());U[N]==="Proof of Payment"||X.push(U)}),N!==-1&&X.forEach(y=>{y.splice(N,1)});const qe=se.length+1;r.autoTable({head:[se],body:X,startY:ae+10,margin:{top:5,right:10,bottom:5,left:10},styles:{cellPadding:2,fontSize:12},headStyles:{fillColor:"#00A36C",textColor:"#ffffff"},columnStyles:{[qe-1]:{align:"center"}}}),r.save("Dit.Ads.pdf")}catch(r){console.error("Error generating PDF:",r)}}return o(null),(s,l)=>{const r=tt;return i(),_("section",null,[e(ye,{title:"Sales Report List"},{default:a(()=>[e(de,null,{default:a(()=>[e(ve,null,{default:a(()=>[e(B,{cols:"6",offset:"2",style:{display:"flex","align-items":"center","margin-left":"25%"}},{default:a(()=>[e(r,{label:"Date Range",modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=c=>x.value=c),config:{mode:"range"}},null,8,["modelValue"]),e(E,{color:"blue",onClick:F(ee,["prevent"]),class:"ml-2"},{default:a(()=>[p("Search")]),_:1},8,["onClick"])]),_:1})]),_:1}),rt]),_:1}),e(de,{class:"d-flex flex-wrap py-4 px-4 gap-2"},{default:a(()=>[t("div",ct,[e(ue,{style:{"font-size":"small"},class:"mr-1"},{default:a(()=>[it]),_:1}),e(K,{modelValue:O.value,"onUpdate:modelValue":[l[1]||(l[1]=c=>O.value=c),be],items:b},null,8,["modelValue"]),e(ue,{style:{"font-size":"small"},class:"ml-1"},{default:a(()=>[dt]),_:1})]),e(me),e(E,{color:"error",onClick:l[2]||(l[2]=F(c=>ke(I.value,m(fe)),["prevent"]))},{default:a(()=>[e(Q,null,{default:a(()=>[p("tabler:file-type-pdf")]),_:1})]),_:1}),e(E,{onClick:l[3]||(l[3]=F(c=>m(lt)(I.value),["prevent"]))},{default:a(()=>[e(Q,null,{default:a(()=>[p("tabler:file-spreadsheet")]),_:1})]),_:1}),e(E,{onClick:F(Ae,["prevent"]),color:"warning"},{default:a(()=>[e(Q,null,{default:a(()=>[p("tabler:printer")]),_:1})]),_:1},8,["onClick"]),e(me),t("div",ut,[t("div",mt,[e(ge,{modelValue:h.value,"onUpdate:modelValue":l[4]||(l[4]=c=>h.value=c),label:"Search",class:"search-field",solo:"","append-inner-icon":"mdi-magnify",density:"compact"},null,8,["modelValue"])])]),t("div",ft,[t("div",pt,[e(K,{modelValue:C.value,"onUpdate:modelValue":[l[5]||(l[5]=c=>C.value=c),Ve],label:"Mode Of Payment",items:te.value,"item-title":"item","item-value":"value"},null,8,["modelValue","items"])])])]),_:1}),e(Je,{ref_key:"tableRef",ref:I},{default:a(()=>{var c;return[e(B,{hidden:"",class:"mb-5"},{default:a(()=>[e(pe,{src:m(fe),alt:"Dit.Ads Logo",class:"logo"},null,8,["src"])]),_:1}),yt,t("tbody",null,[(i(!0),_($e,null,We(m(A),(n,$)=>(i(),_("tr",{key:n.id},[t("td",_t,d($+1),1),t("td",ht,d(n.payment.client.firstname)+" "+d(n.payment.client.middlename)+" "+d(n.payment.client.lastname),1),t("td",gt,[n.payment.modeofpayment.name=="Cash"?(i(),k(S,{key:0,color:"red",variant:"tonal"},{default:a(()=>[p(d(n.payment.modeofpayment.name),1)]),_:2},1024)):n.payment.modeofpayment.name=="GCash"?(i(),k(S,{key:1,color:"blue",variant:"tonal"},{default:a(()=>[p(d(n.payment.modeofpayment.name),1)]),_:2},1024)):(i(),k(S,{key:2,color:"success",variant:"tonal"},{default:a(()=>[p(d(n.payment.modeofpayment.name),1)]),_:2},1024))]),n.payment.account?(i(),_("td",vt,d(n.payment.account),1)):(i(),_("td",xt,Pt)),n.payment.modeofpayment.name=="Cash"?(i(),_("td",St,d(n.payment.or_number),1)):n.payment.modeofpayment.name=="GCash"?(i(),_("td",Vt,d(n.payment.reference_number),1)):(i(),_("td",Ct,kt)),t("td",Dt,d(m(at)(n.payment.date_of_payment).format("MMMM DD, YYYY")),1),t("td",It,[n.payment.payment_status=="Approved"?(i(),k(S,{key:0,color:"success",variant:"outlined"},{default:a(()=>[p(d(n.payment.payment_status),1)]),_:2},1024)):w("",!0),n.payment.payment_status=="Pending"?(i(),k(S,{key:1,color:"warning",variant:"outlined"},{default:a(()=>[p(d(n.payment.payment_status),1)]),_:2},1024)):w("",!0),n.payment.payment_status=="Rejected"?(i(),k(S,{key:2,color:"error",variant:"outlined"},{default:a(()=>[p(d(n.payment.payment_status),1)]),_:2},1024)):w("",!0)]),t("td",Rt,[e(S,{color:"primary",variant:"outlined",label:""},{default:a(()=>[p("\u20B1"+d(n.payment.amount)+".00",1)]),_:2},1024)])]))),128)),u.value?(i(),_("tr",Tt,[Ot,t("td",Mt,[e(S,{color:"blue",variant:"outlined"},{default:a(()=>[p(d(u.value),1)]),_:1})]),Lt])):w("",!0)]),((c=g.value)==null?void 0:c.length)==0?(i(),_("tfoot",Nt,[t("tr",null,[t("td",Ut,[t("div",wt,[e(pe,{src:m(je),style:{display:"inline-block","max-width":"100%",width:"35%",height:"55%","object-fit":"cover"}},null,8,["src"]),e(Ge,{color:"primary",indeterminate:"",reverse:""})])])])])):w("",!0)]}),_:1},512),e(Xe,{length:m(xe),modelValue:T.value,"onUpdate:modelValue":l[6]||(l[6]=c=>T.value=c)},null,8,["length","modelValue"])]),_:1}),e(ye,{class:"mt-5"},{default:a(()=>[e(ot)]),_:1}),e(Ze,{fullscreen:"",modelValue:v.value,"onUpdate:modelValue":l[7]||(l[7]=c=>v.value=c),transition:"dialog-bottom-transition"},{default:a(()=>[e(st,{Data:m(A)},null,8,["Data"])]),_:1},8,["modelValue"])])}}});const Xt=et(Yt,[["__scopeId","data-v-652b41c0"]]);export{Xt as default};
